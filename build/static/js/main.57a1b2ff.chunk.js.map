{"version":3,"sources":["utils/action.ts","utils/store.ts","utils/reducer.ts","utils/context.ts","utils/index.ts","utils/event.ts","core/item.ts","core/group.ts","Components/Drag.tsx","Components/SelectArea.tsx","editor.ts","Widgets/types/index.ts","types/index.ts","Views/Item.tsx","Views/Canvas.tsx","Views/BorderArea.tsx","Views/ContextMenu.tsx","Views/Grid.tsx","Views/NoZoomArea.tsx","Views/ResizeHandle.tsx","Views/SelectArea.tsx","Views/ZoomArea.tsx","Views/Editor.tsx","Views/index.ts","core/editor.ts","core/index.ts","Components/Zoom.tsx","Components/ResizeHandle.tsx","Components/ItemBorder.ts","Components/ItemContextmenu.ts","Components/index.ts","layout/components/IconFont.ts","layout/ItemPanel.tsx","layout/schema/canvas.ts","layout/schema/item.ts","layout/schema/widgets/FieldTemplate.tsx","layout/schema/widgets/index.ts","layout/schema/widgets/StringInput.tsx","layout/schema/widgets/InputNumber.tsx","layout/schema/widgets/Select.tsx","layout/StylePanel.tsx","layout/Toolbar.tsx","App.tsx","serviceWorker.ts","index.tsx","Widgets/Text/index.tsx","Widgets/index.ts"],"names":["actions","SET_CANVAS_SIZE","state","payload","editorInstance","canvasSize","SET_CANVAS_TRANSFORM","canvasTransform","ADD_ITEM","items","concat","Object","toConsumableArray","ADD_ITEM_BORDER","Array","isArray","forEach","item","bordered","add","CLEAR_ITEM_BORDER","Set","CLEAR_ITEM_SELECT","selected","DELETE_ITEM","_","pull","apply","delete","GROUP_ITEM","groupId","Date","now","Math","round","random","MOVE_ITEM","_ref","x","y","transform","RESIZE_ITEM","_ref2","width","height","size","REMOVE_ITEM_BORDER","ROTATE_ITEM","r","SELECT_GROUP","filter","i","SELECT_ITEM","UN_GROUP_ITEM","undefined","UN_SELECT_ITEM","SET_ITEM_DATA","map","id","props","data","INITIAL_STATE","Editor","makeStore","createStore","reducer","objectSpread","create","StoreContext","useMappedState","useStoreDispatch","useDispatch","editor","params","emit","arguments","length","action","actionFunc","type","ContextMenuContext","createContext","setContextMenuProps","__webpack_require__","d","__webpack_exports__","EventBus","event","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","bus","Subject","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","next","pipe","res","indexOf","Item","status","itemView","Group","_Item","_this","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","show","single","minXItem","minYItem","maxXItem","maxYItem","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","minBy","maxBy","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","moveEvent","fromEvent","window","upEvent","e","button","keyDownEvent","keyUpEvent","pointerStart","useDragState","domRef","useSpace","_ref$scale","scale","spaceKey","useRef","_useState","useState","_useState2","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","setStatus","useEffect","keyEvent","current","switchMap","code","classList","subscribe","remove","unsubscribe","refEvent","startEvent","preventDefault","stopPropagation","mx","my","clientX","clientY","takeUntil","endEvent","moveEv","useSelectArea","_useState3","_useState4","left","setLeft","_useState5","_useState6","top","setTop","_useState7","_useState8","setWidth","_useState9","_useState10","setHeight","subscription","contains","down","ev","abs","rect","getBoundingClientRect","center","move","_Views__WEBPACK_IMPORTED_MODULE_0__","_core__WEBPACK_IMPORTED_MODULE_1__","ItemView","Widget","Widgets","dispatch","useContext","_useMappedState","s","_useDragState","moveStatus","slicedToArray","positionStart","Map","set","has","itemMap","get","useItemBorderEvent","useItemContextMenuEvent","useItemState","react_default","a","createElement","data-id","className","ref","style","Canvas","_useCanvasState","itemList","useCanvasState","Item_ItemView","BorderArea","borderedList","Fragment","BorderArea_ItemBordered","ItemBordered","_item$size","_item$transform","ContextMenu","visible","position","onClick","onClose","ContextMenu_Menu","menus","Menu","menu","hidden","react","topDivider","title","children","bottomDivider","Grid","xmlns","patternUnits","fill","stroke","strokeWidth","NoZoomArea","_ref$editorInstance","_useMappedState$size","ResizeHandle","_useResizeHandleState","group","setGroup","_useResizeHandle","useResizeHandle","resizeStatus","direction","angle","itemMapStart","itemsMap","sizeMap","getRotateDeg","clear","useResizeHandleState","display","cursor","original","rotated","mergedRotateDeg","SelectAreaView","_useSelectAreaState","selectDomRef","_ref3","selectedItems","_useSelectArea","selectRect","isIn","flag","selectedItem","useSelectAreaState","from","to","ZoomArea","_ref2$editorInstance","_useMappedState$trans","Content","_useEditorState","editorContainerRef","storeDispatch","contextMenuProps","zoomTrans","useZoomState","intensity","document","ox","oy","useEditorState","editorView","utils","Provider","NoZoomArea_NoZoomArea","Grid_Grid","ZoomArea_ZoomArea","Canvas_Canvas","BorderArea_BorderArea","ResizeHandle_ResizeHandle","SelectArea_SelectAreaView","ContextMenu_ContextMenu","EditorView","store","setStore","Editor_Content","Editor_EditorView","_EventBus","config","classCallCheck","possibleConstructorReturn","getPrototypeOf","inherits","createClass","editor_Editor","trans","setTransform","ctrlKey","metaKey","_props$intensity","canvasDom","querySelector","wheelDelta","deltaY","delta","oxDelta","oyDelta","wheel","listenEvent","start","oldRotateDeg","rotateDeg","setDeg","sizeState","setResizeState","target","eleRect","end","a2","pow","b2","c2","acos","sqrt","PI","getRotate","menuWillShow","setMenuWillShow","findIndex","itemContextMenuAction","Drag","Zoom_useZoomState","IconFont","Icon","createFromIconfontCN","scriptUrl","ItemPanel","ItemPanel_ItemIcon","ItemIcon","_useItemIconState","previewPosition","setPreview","editorDom","_editor$canvasTransfo","_editorDom$getBoundin","up","useItemIconState","transformOrigin","zIndex","border","boxSizing","canvasSchema","schema","properties","uiSchema","ui:widget","ui:options","span","step","min","labelAlign","precision","itemSchema","hideLabel","labelFixed","max","ObjectFieldTemplate","safeOptions","labelSpan","row","gutter","element","content","FieldTemplate","classNames","label","help","description","errors","col","widgets","StringInput","onChange","disabled","_props$options","options","prefix","addonAfter","addonBefore","suffix","allowClear","input","assign","placeholder","InputNumber","required","autofocus","input_number","val","autoFocus","Select","es_select","enum","index","Option","StylePanel","_useCanvasStylePanelS","canvasFormData","setCanvasFormData","on","delay","useCanvasStylePanelState","_useCanvasStylePanelS2","updateCanvas","_useBaseItemStylePane","itemBaseStyle","setItemBaseStyle","groupStart","increaseX","increaseY","increaseW","increaseH","keys","useBaseItemStylePanelState","_useBaseItemStylePane2","updateItemBaseStyle","_useCustomItemStylePa","itemProps","setItemProps","setItem","itemSet","values","useCustomItemStylePanelState","_useCustomItemStylePa2","customItemStyle","updateCustomItemStyle","collapse","defaultActiveKey","Panel","header","lib_default","formData","formWidgets","edit","WidgetPropsSchemeMap","Toolbar","_useToolbarState","setItems","setGroupId","isGroup","hasSelected","canGroup","toolbarStatus","setScale","setAlign","useToolbarState","_useToolbarState$tool","onDoubleClick","App","setEditor","Toolbar_Toolbar","ItemPanel_ItemPanel","src_editor","StylePanel_StylePanel","Boolean","location","hostname","match","ReactDOM","render","App_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister","defaultProps","text","textAlign","verticalAlign","Text","_Users_huangjiangheng_Projects_dashboard_editor_react_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1___default","justifyContent","alignItems","TextPropsSchema","TextPropsUiSchema","_Text__WEBPACK_IMPORTED_MODULE_0__","TEXT","TextProps"],"mappings":"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","file":"static/js/main.57a1b2ff.chunk.js","sourcesContent":["import _ from \"lodash\";\nimport { IEventTypes } from \"../types\";\nimport { IState } from \"./store\";\n\nconst actions: { [K in keyof IEventTypes]: (state: IState, payload: IEventTypes[K]) => void } = {\n  SET_CANVAS_SIZE: (state, payload) => {\n    state.editorInstance.canvasSize = payload;\n  },\n  SET_CANVAS_TRANSFORM: (state, payload) => {\n    state.editorInstance.canvasTransform = payload;\n  },\n  ADD_ITEM: (state, payload) => {\n    state.editorInstance.items = [...state.editorInstance.items, payload];\n  },\n  ADD_ITEM_BORDER: (state, payload) => {\n    if (Array.isArray(payload)) {\n      payload.forEach(item => state.bordered.add(item));\n    } else {\n      state.bordered.add(payload);\n    }\n  },\n  CLEAR_ITEM_BORDER: state => {\n    state.bordered = new Set();\n  },\n  CLEAR_ITEM_SELECT: state => {\n    state.bordered = new Set();\n    state.selected = new Set();\n  },\n  DELETE_ITEM: (state, payload) => {\n    state.editorInstance.items = _.pull(state.editorInstance.items, ...payload);\n    payload.forEach(item => {\n      state.bordered.delete(item);\n      state.selected.delete(item);\n    });\n    state.bordered = new Set([...state.bordered]);\n    state.selected = new Set([...state.selected]);\n  },\n  GROUP_ITEM: (state, payload) => {\n    const groupId = `group_${Date.now()}_${Math.round(Math.random() * 100000)}`;\n    payload.forEach(item => {\n      item.groupId = groupId;\n    });\n    state.selected = new Set([...state.selected]);\n  },\n  MOVE_ITEM: (state, payload) => {\n    payload.forEach(({ x, y }, item) => {\n      item.transform.x = Math.round(x);\n      item.transform.y = Math.round(y);\n    });\n    state.selected = new Set([...state.selected]);\n  },\n  RESIZE_ITEM: (state, payload) => {\n    payload.forEach(({ width, height }, item) => {\n      item.size = { width: Math.round(width), height: Math.round(height) };\n    });\n    state.selected = new Set([...state.selected]);\n  },\n  REMOVE_ITEM_BORDER: (state, payload) => {\n    if (Array.isArray(payload)) {\n      payload.forEach(item => state.bordered.delete(item));\n    } else {\n      state.bordered.delete(payload);\n    }\n  },\n  ROTATE_ITEM: (state, payload) => {\n    payload.item.transform.r = payload.r;\n    state.selected = new Set([...state.selected]);\n  },\n  SELECT_GROUP: (state, payload) => {\n    const items = state.editorInstance.items.filter(i => i.groupId === payload);\n    state.bordered = new Set(items);\n    state.selected = new Set(items);\n  },\n  SELECT_ITEM: (state, payload) => {\n    state.bordered.add(payload);\n    state.selected.add(payload);\n    state.bordered = new Set([...state.bordered]);\n    state.selected = new Set([...state.selected]);\n  },\n  UN_GROUP_ITEM: (state, payload) => {\n    state.editorInstance.items.forEach(item => {\n      if (item.groupId && item.groupId === payload) {\n        item.groupId = undefined;\n      }\n    });\n  },\n  UN_SELECT_ITEM: (state, payload) => {\n    if (Array.isArray(payload)) {\n      payload.forEach(item => {\n        state.bordered.delete(item);\n        state.selected.delete(item);\n      });\n    } else {\n      state.bordered.delete(payload);\n      state.selected.delete(payload);\n    }\n    state.bordered = new Set([...state.bordered]);\n    state.selected = new Set([...state.selected]);\n  },\n  SET_ITEM_DATA: (state, payload) => {\n    state.editorInstance.items = state.editorInstance.items.map(item => {\n      if (item.id === payload.id) {\n        item.props = payload.data;\n      }\n      return item;\n    });\n  }\n};\n\nexport default actions;\n","import { createStore, Dispatch, Store } from \"redux\";\nimport { create } from \"redux-react-hook\";\nimport { Editor, Item } from \"../core\";\nimport { IEventTypes } from \"../types\";\nimport { reducer } from \"./reducer\";\n\nexport interface IState {\n  editorInstance: Editor;\n  bordered: Set<Item>;\n  selected: Set<Item>;\n}\n\ninterface IActionType {\n  type: keyof IEventTypes;\n  payload: IEventTypes[IActionType[\"type\"]];\n}\n\nexport const INITIAL_STATE: IState = {\n  editorInstance: new Editor(),\n  bordered: new Set(),\n  selected: new Set()\n};\n\nexport function makeStore<K extends keyof IEventTypes>(\n  state?: any\n): Store<IState, { type: K; payload: IEventTypes[K] }> {\n  return createStore<IState, any, IState, IState>(reducer, { ...INITIAL_STATE, ...state });\n}\nexport const { StoreContext, useMappedState, useDispatch: useStoreDispatch } = create<\n  IState,\n  IActionType,\n  Store<IState, IActionType>,\n  Dispatch<IActionType>\n>();\n\nexport function useDispatch() {\n  const { editor } = useMappedState(({ editorInstance }) => ({\n    editor: editorInstance\n  }));\n  return function a<K extends keyof IEventTypes>(params: { type: K; payload: IEventTypes[K] }) {\n    editor.emit(params);\n  };\n}\n","import { IEventTypes } from \"../types\";\nimport actions from \"./action\";\nimport { INITIAL_STATE, IState } from \"./store\";\n\nexport function reducer<K extends keyof IEventTypes>(\n  state: IState | undefined = INITIAL_STATE,\n  action: { type: K; payload: IEventTypes[K] }\n): IState {\n  const actionFunc: (state: IState, payload: any) => void = actions[action.type];\n  if (actionFunc) {\n    actionFunc(state, action.payload);\n    state.editorInstance.selected = state.selected;\n  }\n  return { ...state };\n}\n","import { createContext } from \"react\";\nimport { IContextMenuContext } from \"../types\";\n\nexport const ContextMenuContext = createContext<IContextMenuContext>({\n  setContextMenuProps: () => \"\"\n});\n","export * from \"./event\";\nexport * from \"./reducer\";\nexport * from \"./store\";\nexport * from \"./context\";\n","import { Observable, Subject } from \"rxjs\";\nimport { filter, map } from \"rxjs/operators\";\nimport { IEventTypes } from \"../types\";\n\nexport class EventBus {\n  public bus: Subject<any>;\n\n  constructor(event?: EventBus) {\n    this.bus = event instanceof EventBus ? event.bus : new Subject();\n  }\n\n  public emit<K extends keyof IEventTypes>(params: { type: K; payload: IEventTypes[K] }) {\n    this.bus.next(params);\n  }\n\n  public on<K extends keyof IEventTypes>(type: K | K[]): Observable<IEventTypes[K]> {\n    return this.bus.pipe(\n      filter(res => {\n        if (Array.isArray(type)) {\n          return type.indexOf(res.type) !== -1;\n        }\n        return res.type === type;\n      }),\n      map(res => res.payload)\n    );\n  }\n}\n","import { ISize } from \"../types\";\nimport { IWidgetTypes } from \"../Widgets\";\n\ntype k = keyof IWidgetTypes;\n\nexport class Item {\n  public id: string;\n  public type: k | \"GROUP\";\n  public props: IWidgetTypes[k] | undefined;\n  public transform = { r: 0, x: 0, y: 0 };\n  public size: ISize = { width: 100, height: 50 };\n  public status: \"dragging\" | \"resizing\" | null = null;\n  public itemView: HTMLElement | undefined;\n  public groupId?: string;\n\n  constructor(type: k | \"GROUP\", props?: IWidgetTypes[k]) {\n    this.type = type;\n    this.props = props;\n    this.id = `item_${Date.now()}_${Math.round(Math.random() * 1000)}`;\n  }\n}\n","import _ from \"lodash\";\nimport { ISize } from \"../types\";\nimport { Item } from \"./item\";\n\nexport class Group extends Item {\n  public items: Item[];\n  public show = false;\n  public single = false;\n  public minXItem: Item | undefined;\n  public minYItem: Item | undefined;\n  public maxXItem: Item | undefined;\n  public maxYItem: Item | undefined;\n\n  constructor(scale = 1, items: Item[], canvasSize: ISize) {\n    super(\"GROUP\");\n    this.show = !!items.length;\n    this.single = items.length === 1;\n    this.items = [...items];\n\n    if (this.show) {\n      if (this.single) {\n        this.size = {\n          width: (this.items[0].size.width / canvasSize.width) * 100,\n          height: (this.items[0].size.height / canvasSize.height) * 100\n        };\n        this.transform = {\n          r: this.items[0].transform.r,\n          x: (this.items[0].transform.x / canvasSize.width) * 100,\n          y: (this.items[0].transform.y / canvasSize.height) * 100\n        };\n      } else {\n        this.minXItem = _.minBy(items, item => item.transform.x);\n        this.minYItem = _.minBy(items, item => item.transform.y);\n        this.maxXItem = _.maxBy(items, item => item.transform.x + item.size.width);\n        this.maxYItem = _.maxBy(items, item => item.transform.y + item.size.height);\n        this.size = {\n          width:\n            ((this.maxXItem!.transform.x + this.maxXItem!.size.width - this.minXItem!.transform.x) /\n              canvasSize.width) *\n            100,\n          height:\n            ((this.maxYItem!.transform.y + this.maxYItem!.size.height - this.minYItem!.transform.y) /\n              canvasSize.height) *\n            100\n        };\n        this.transform = {\n          r: 0,\n          x: (this.minXItem!.transform.x / canvasSize.width) * 100,\n          y: (this.minYItem!.transform.y / canvasSize.height) * 100\n        };\n      }\n    }\n  }\n}\n","import { MutableRefObject, useEffect, useRef, useState } from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { filter, map, switchMap, takeUntil } from \"rxjs/operators\";\n\nexport interface IDragWrapProps {\n  domRef: MutableRefObject<HTMLElement | null>;\n  scale?: number;\n  useSpace?: boolean;\n}\n\ninterface IMoveStatus {\n  status: \"drag-start\" | \"drag-move\" | \"drag-end\";\n  event: PointerEvent;\n  mx: number;\n  my: number;\n}\n\nconst moveEvent = fromEvent<PointerEvent>(window, \"pointermove\");\nconst upEvent = fromEvent<PointerEvent>(window, \"pointerup\").pipe(filter(e => e.button === 0));\nconst keyDownEvent = fromEvent<KeyboardEvent>(window, \"keydown\");\nconst keyUpEvent = fromEvent<KeyboardEvent>(window, \"keyup\");\nlet pointerStart: [number, number] | null = null;\n\nexport function useDragState({ domRef, useSpace, scale = 1 }: IDragWrapProps): [IMoveStatus | null] {\n  const spaceKey = useRef<boolean>(false);\n  const [status, setStatus] = useState<IMoveStatus | null>(null);\n\n  useEffect(listenKeyEvent, [domRef]);\n\n  useEffect(listenEvent, [domRef, scale]);\n\n  return [status];\n\n  function listenKeyEvent() {\n    let keyEvent: Subscription;\n    if (domRef.current) {\n      keyEvent = keyDownEvent\n        .pipe(\n          switchMap(e => {\n            if (e.code === \"Space\") {\n              spaceKey.current = true;\n              if (useSpace && domRef.current) {\n                domRef.current.classList.add(\"in-drag\");\n              }\n            }\n            return keyUpEvent;\n          }),\n          filter(e => e.code === \"Space\")\n        )\n        .subscribe(() => {\n          spaceKey.current = false;\n          if (domRef.current) {\n            domRef.current.classList.remove(\"in-drag\");\n          }\n        });\n    }\n    return () => {\n      if (keyEvent) {\n        keyEvent.unsubscribe();\n      }\n    };\n  }\n\n  function listenEvent() {\n    let refEvent: Subscription | undefined;\n    if (domRef.current) {\n      refEvent = fromEvent<PointerEvent>(domRef.current, \"pointerdown\")\n        .pipe(\n          filter(e => e.button === 0),\n          filter(() => (useSpace ? spaceKey.current : !spaceKey.current)),\n          switchMap(startEvent => {\n            startEvent.preventDefault();\n            startEvent.stopPropagation();\n            domRef.current!.classList.add(\"on-drag\");\n            setStatus({ status: \"drag-start\", event: startEvent, mx: 0, my: 0 });\n            pointerStart = [startEvent.clientX, startEvent.clientY];\n            return moveEvent.pipe(\n              takeUntil(\n                upEvent.pipe(\n                  map(endEvent => {\n                    domRef.current!.classList.remove(\"on-drag\");\n                    setStatus({ status: \"drag-end\", event: endEvent, mx: 0, my: 0 });\n                    pointerStart = null;\n                  })\n                )\n              )\n            );\n          }),\n          filter(() => (useSpace ? spaceKey.current : !spaceKey.current))\n        )\n        .subscribe(moveEv => {\n          if (pointerStart) {\n            setStatus({\n              status: \"drag-move\",\n              event: moveEv,\n              mx: (moveEv.clientX - pointerStart[0]) / scale,\n              my: (moveEv.clientY - pointerStart[1]) / scale\n            });\n          }\n        });\n    }\n    return () => {\n      if (refEvent) {\n        refEvent.unsubscribe();\n      }\n    };\n  }\n}\n","import {\n  MutableRefObject,\n  PropsWithChildren,\n  useEffect,\n  useState\n} from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { filter, map, switchMap, takeUntil } from \"rxjs/operators\";\n\nexport interface ISelectAreaProps\n  extends PropsWithChildren<{\n    domRef: MutableRefObject<HTMLElement | null>;\n  }> {}\n\ntype SelectStatusType = \"start\" | \"moving\" | \"end\" | null;\n\nconst moveEvent = fromEvent<PointerEvent>(window, \"pointermove\");\nconst upEvent = fromEvent<PointerEvent>(window, \"pointerup\").pipe(\n  filter(e => e.button === 0)\n);\nlet pointerStart: [number, number] | null = null;\n\nexport const useSelectArea = (props: ISelectAreaProps) => {\n  const [status, setStatus] = useState<SelectStatusType>(null);\n  const [left, setLeft] = useState(0);\n  const [top, setTop] = useState(0);\n  const [width, setWidth] = useState(0);\n  const [height, setHeight] = useState(0);\n\n  useEffect(listenEvent, [props.domRef]);\n\n  return { status, left, top, height, width, setStatus };\n\n  function listenEvent() {\n    let subscription: Subscription;\n    if (props.domRef && props.domRef.current) {\n      subscription = fromEvent<PointerEvent>(\n        props.domRef.current,\n        \"pointerdown\"\n      )\n        .pipe(\n          filter(e => e.button === 0),\n          filter(\n            () =>\n              !!(\n                props.domRef &&\n                props.domRef.current &&\n                !props.domRef.current.classList.contains(\"in-drag\")\n              )\n          ),\n          switchMap(e => {\n            down(e);\n            return moveEvent.pipe(takeUntil(upEvent.pipe(map(ev => up(ev)))));\n          })\n        )\n        .subscribe(e => move(e));\n    }\n    return () => {\n      if (subscription) {\n        subscription.unsubscribe();\n      }\n    };\n  }\n\n  function down(e: PointerEvent) {\n    setStatus(\"start\");\n    pointerStart = [e.clientX, e.clientY];\n  }\n  function move(e: PointerEvent) {\n    if (pointerStart && props.domRef && props.domRef.current) {\n      e.preventDefault();\n      setStatus(\"moving\");\n      const mx = e.clientX - pointerStart[0];\n      const my = e.clientY - pointerStart[1];\n      setWidth(Math.abs(mx));\n      setHeight(Math.abs(my));\n      const rect = props.domRef.current.getBoundingClientRect();\n      const center = [pointerStart[0] - rect.left, pointerStart[1] - rect.top];\n      setLeft(mx > 0 ? center[0] : center[0] + mx);\n      setTop(my > 0 ? center[1] : center[1] + my);\n    }\n  }\n  function up(e: PointerEvent) {\n    setStatus(\"end\");\n    pointerStart = null;\n  }\n};\n","export * from \"./Views\";\nexport * from \"./core\";\nexport * from \"./types\";\nexport * from \"./Components\";\nexport * from \"./utils\";\n","export interface IWidgetProps {\n  [key: string]: any;\n}\n\nexport * from \"./Text\";\n","import { Item } from \"../core\";\nimport { ISize, ITransform } from \"./Editor\";\n\nexport * from \"./ContextMenu\";\nexport * from \"./Editor\";\n\nexport interface IEventTypes {\n  SET_CANVAS_TRANSFORM: ITransform;\n  SET_CANVAS_SIZE: ISize;\n  ADD_ITEM: Item;\n  ROTATE_ITEM: { item: Item; r: number };\n  ADD_ITEM_BORDER: Item[];\n  REMOVE_ITEM_BORDER: Item[];\n  CLEAR_ITEM_BORDER: undefined;\n  CLEAR_ITEM_SELECT: undefined;\n  SELECT_ITEM: Item;\n  UN_SELECT_ITEM: Item | Item[];\n  DELETE_ITEM: Item[];\n  GROUP_ITEM: Item[];\n  UN_GROUP_ITEM: string;\n  SELECT_GROUP: string;\n  MOVE_ITEM: Map<Item, { x: number; y: number; mx: number; my: number }>;\n  RESIZE_ITEM: Map<Item, { width: number; height: number }>;\n  SET_ITEM_DATA: { id: string; data: any };\n}\n","import React, { useContext, useEffect, useRef } from \"react\";\nimport { useItemBorderEvent, useItemContextMenuEvent } from \"../Components\";\nimport { useDragState } from \"../Components/Drag\";\nimport { Item } from \"../core\";\nimport { ContextMenuContext, useDispatch, useMappedState } from \"../utils\";\nimport { Widgets } from \"../Widgets\";\n\nexport const ItemView: React.FC<{ item: Item }> = props => {\n  let Widget;\n  if (props.item.type !== \"GROUP\") {\n    Widget = Widgets[props.item.type];\n    if (!props.item.props) {\n      props.item.props = Widget.props;\n    }\n  }\n  const { item } = props;\n  const { domRef } = useItemState(props);\n\n  return (\n    <div\n      data-id={`item_view_${item.id}`}\n      className=\"item-view\"\n      ref={ref => {\n        if (ref) {\n          domRef.current = ref;\n          item.itemView = ref;\n        }\n      }}\n      style={{\n        width: `${item.size.width}px`,\n        height: `${item.size.height}px`,\n        transform: `translate3d(${item.transform.x}px,${item.transform.y}px,0) rotate(${item.transform.r}deg)`\n      }}\n    >\n      {Widget ? <Widget.Widget {...item.props} /> : \"\"}\n    </div>\n  );\n};\n\nlet positionStart: Map<Item, { x: number; y: number }> | null = null;\nfunction useItemState(props: { item: Item }) {\n  const domRef = useRef<HTMLElement | null>(null);\n  const dispatch = useDispatch();\n  const { setContextMenuProps } = useContext(ContextMenuContext);\n  const { scale, items } = useMappedState(({ editorInstance, selected }) => ({\n    scale: editorInstance.canvasTransform.s,\n    items: selected\n  }));\n\n  const [moveStatus] = useDragState({ domRef, scale });\n\n  useEffect(() => {\n    if (moveStatus) {\n      switch (moveStatus.status) {\n        case \"drag-start\":\n          positionStart = new Map();\n          items.forEach(item => {\n            positionStart!.set(item, { x: item.transform.x, y: item.transform.y });\n          });\n          if (setContextMenuProps) {\n            setContextMenuProps(undefined);\n          }\n          if (!new Set(items).has(props.item)) {\n            dispatch({ type: \"CLEAR_ITEM_SELECT\", payload: undefined });\n            if (props.item.groupId) {\n              dispatch({ type: \"SELECT_GROUP\", payload: props.item.groupId });\n            } else {\n              dispatch({ type: \"SELECT_ITEM\", payload: props.item });\n            }\n          }\n          break;\n        case \"drag-move\":\n          if (positionStart) {\n            const itemMap = new Map();\n            items.forEach(item => {\n              if (positionStart && positionStart.has(item)) {\n                itemMap.set(item, {\n                  x: positionStart.get(item)!.x + Math.round(moveStatus.mx),\n                  y: positionStart.get(item)!.y + Math.round(moveStatus.my)\n                });\n              }\n            });\n            dispatch({ type: \"MOVE_ITEM\", payload: itemMap });\n          }\n          break;\n        case \"drag-end\":\n          positionStart = null;\n          break;\n      }\n    }\n  }, [moveStatus]);\n\n  useItemBorderEvent({ domRef, item: props.item });\n  useItemContextMenuEvent({ items: [...items], item: props.item, domRef: domRef.current });\n\n  return { domRef };\n}\n","import React, { useLayoutEffect, useRef } from \"react\";\nimport { Item } from \"../core\";\nimport { useMappedState } from \"../utils\";\nimport { ItemView } from \"./Item\";\n\nexport const Canvas = () => {\n  const { size, items, domRef } = useCanvasState();\n\n  return (\n    <div\n      className=\"canvas\"\n      ref={ref => {\n        if (ref) {\n          domRef.current = ref;\n        }\n      }}\n      style={{ width: `${size.width}px`, height: `${size.height}px` }}\n    >\n      {items.map(item => (\n        <ItemView key={`item-view_${item.id}`} item={item} />\n      ))}\n    </div>\n  );\n};\n\nexport function useCanvasState() {\n  const domRef = useRef<HTMLElement | undefined>();\n  const { editor, size, items: itemList } = useMappedState(\n    ({ editorInstance }) => ({\n      editor: editorInstance,\n      items: editorInstance.items,\n      size: editorInstance.canvasSize\n    })\n  );\n\n  return { domRef, editor, size, items: itemList };\n}\n","import React from \"react\";\nimport { Item } from \"../core\";\nimport { ISize } from \"../types\";\nimport { useMappedState } from \"../utils\";\n\nexport const BorderArea: React.FC = () => {\n  const { borderedList, scale, canvasSize } = useMappedState(({ bordered, editorInstance }) => ({\n    borderedList: [...bordered],\n    scale: editorInstance.canvasTransform.s,\n    canvasSize: editorInstance.canvasSize\n  }));\n\n  return (\n    <React.Fragment>\n      {borderedList.map(bordered => (\n        <ItemBordered\n          key={`item-border-${bordered.id}`}\n          item={bordered}\n          scale={scale}\n          canvasSize={canvasSize}\n        />\n      ))}\n    </React.Fragment>\n  );\n};\n\nexport const ItemBordered: React.FC<{ item: Item; scale: number; canvasSize: ISize }> = ({\n  item,\n  scale,\n  canvasSize\n}) => {\n  const {\n    size: { width, height },\n    transform: { r, x, y }\n  } = item;\n  return (\n    <div\n      className=\"item-border\"\n      style={{\n        width: `${(width / canvasSize.width) * 100}%`,\n        height: `${(height / canvasSize.height) * 100}%`,\n        left: `${(x / canvasSize.width) * 100}%`,\n        top: `${(y / canvasSize.height) * 100}%`,\n        transform: `rotate(${r}deg)`\n      }}\n    />\n  );\n};\n","import React, { FC, Fragment } from \"react\";\nimport { IContextMenu, IContextMenuProps } from \"../types\";\n\nexport const ContextMenu: FC<IContextMenuProps> = props => {\n  if (props && props.visible) {\n    return (\n      <div\n        id=\"context-menu\"\n        style={{ left: props.position.x, top: props.position.y }}\n        onClick={() => {\n          props.onClose();\n        }}\n      >\n        <section className=\"mb-contextmenu\">\n          <Menu menus={props.menus} action={props.onClick} />\n        </section>\n      </div>\n    );\n  }\n  return null;\n};\n\nconst Menu = (props: {\n  menus: IContextMenu[];\n  action: IContextMenuProps[\"onClick\"];\n  className?: string;\n}) => {\n  return (\n    <ul className={props.className}>\n      {props.menus.map(menu => {\n        if (\n          !menu.hidden ||\n          (typeof menu.hidden === \"function\" && !menu.hidden())\n        ) {\n          return (\n            <Fragment key={`contextmenu_item_${menu.key}`}>\n              {menu.topDivider ? <div className=\"divider\" /> : \"\"}\n              <li\n                onClick={() => {\n                  props.action(menu);\n                }}\n              >\n                <a>\n                  <span>{menu.title}</span>\n                  {menu.children && menu.children.length ? (\n                    <i className=\"fa fa-caret-right\" />\n                  ) : (\n                    \"\"\n                  )}\n                </a>\n                {menu.children && menu.children.length ? (\n                  <Menu\n                    className=\"mb-contextmenu sub-menu\"\n                    menus={menu.children!}\n                    action={props.action}\n                  />\n                ) : (\n                  \"\"\n                )}\n              </li>\n              {menu.bottomDivider ? <div className=\"divider\" /> : \"\"}\n            </Fragment>\n          );\n        }\n      })}\n    </ul>\n  );\n};\n","import React from \"react\";\nimport { useMappedState } from \"../utils\";\n\nexport const Grid: React.FC = () => {\n  const { scale } = useMappedState(\n    ({ editorInstance: { canvasTransform } }) => ({\n      scale: canvasTransform.s,\n    }),\n  );\n\n  return (\n    <div className=\"grid-container\">\n      <svg width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\">\n        <defs>\n          <pattern\n            id=\"grid\"\n            width={10 * scale}\n            height={10 * scale}\n            patternUnits=\"userSpaceOnUse\"\n          >\n            <path\n              d={`M ${10 * scale} 0 L 0 0 0 ${10 * scale}`}\n              fill=\"none\"\n              stroke=\"rgba(207, 207, 207, 0.8)\"\n              strokeWidth=\"1\"\n            />\n          </pattern>\n        </defs>\n        <rect width=\"100%\" height=\"100%\" fill=\"url(#grid)\" />\n      </svg>\n    </div>\n  );\n};\n","import React from \"react\";\nimport { useMappedState } from \"../utils\";\n\nexport const NoZoomArea: React.FC = (props) => {\n  const {\n    size: { width, height },\n    transform,\n  } = useMappedState(({ editorInstance: { canvasSize, canvasTransform } }) => ({\n    size: canvasSize,\n    transform: canvasTransform,\n  }));\n  return (\n    <div\n      className=\"no-zoom-area\"\n      style={{\n        width: `${width * transform.s}px`,\n        height: `${height * transform.s}px`,\n        transform: `translate3d(${transform.x}px,${transform.y}px,0)`,\n      }}\n    >\n      {props.children}\n    </div>\n  );\n};\n","import React, { FC, useEffect, useRef, useState } from \"react\";\nimport { useResizeHandle } from \"../Components\";\nimport { Group, Item } from \"../core\";\nimport { useDispatch, useMappedState } from \"../utils\";\n\nexport const ResizeHandle: FC = () => {\n  const { domRef, group } = useResizeHandleState();\n  return (\n    <div\n      className=\"select-handle\"\n      style={{\n        display: group.show ? \"block\" : \"none\",\n        width: `${group.size.width}%`,\n        height: `${group.size.height}%`,\n        left: `${group.transform.x}%`,\n        top: `${group.transform.y}%`,\n        transform: `rotate(${group.transform.r}deg)`\n      }}\n      ref={ref => {\n        if (ref) {\n          domRef.current = ref;\n        }\n      }}\n    >\n      <div className=\"rect\">\n        {/* group.single ? (\n          <div className=\"rotate\">\n            <svg width=\"14\" height=\"14\" xmlns=\"http://www.w3.org/2000/svg\">\n              <path\n                // tslint:disable-next-line:max-line-length\n                d=\"M10.536 3.464A5 5 0 1 0 11 10l1.424 1.425a7 7 0 1 1-.475-9.374L13.659.34A.2.2 0 0 1 14 .483V5.5a.5.5 0 0 1-.5.5H8.483a.2.2 0 0 1-.142-.341l2.195-2.195z\"\n                fill=\"#eb5648\"\n                fillRule=\"nonzero\"\n              />\n            </svg>\n          </div>\n        ) : (\n          \"\"\n        ) */}\n        <div className=\"n block\" style={{ cursor: \"n-resize\" }} />\n        <div className=\"s block\" style={{ cursor: \"s-resize\" }} />\n        <div className=\"e block\" style={{ cursor: \"e-resize\" }} />\n        <div className=\"w block\" style={{ cursor: \"w-resize\" }} />\n        <div className=\"ne block\" style={{ cursor: \"ne-resize\" }} />\n        <div className=\"nw block\" style={{ cursor: \"nw-resize\" }} />\n        <div className=\"se block\" style={{ cursor: \"se-resize\" }} />\n        <div className=\"sw block\" style={{ cursor: \"sw-resize\" }} />\n      </div>\n    </div>\n  );\n};\n\nconst itemMapStart: Map<Item, { r: number; x: number; y: number; width: number; height: number }> = new Map();\n\nfunction useResizeHandleState() {\n  const dispatch = useDispatch();\n  const domRef = useRef<HTMLElement | undefined>();\n  const { scale, items, editor } = useMappedState(({ editorInstance, selected }) => ({\n    editor: editorInstance,\n    scale: editorInstance.canvasTransform.s,\n    items: selected\n  }));\n  const [group, setGroup] = useState<Group>(new Group(scale, [], editor.canvasSize));\n\n  const [resizeStatus] = useResizeHandle({ domRef });\n\n  useEffect(() => {\n    if (items.size) {\n      setGroup(new Group(scale, [...items], editor.canvasSize));\n    } else {\n      setGroup(new Group(scale, [], editor.canvasSize));\n    }\n  }, [items]);\n\n  useEffect(() => {\n    const { status, mx, my, direction, angle } = resizeStatus;\n    switch (status) {\n      case \"start\":\n        items.forEach(item => {\n          itemMapStart.set(item, { ...item.transform, ...item.size });\n        });\n        break;\n      case \"resizing\":\n        if (itemMapStart.size) {\n          const itemsMap = sizeMap(mx / scale, my / scale, direction);\n          dispatch({ type: \"RESIZE_ITEM\", payload: itemsMap });\n          dispatch({ type: \"MOVE_ITEM\", payload: itemsMap });\n        }\n        break;\n      case \"rotating\":\n        if (itemMapStart.size) {\n          items.forEach(item => {\n            if (itemMapStart.get(item)) {\n              dispatch({\n                type: \"ROTATE_ITEM\",\n                payload: { item, r: getRotateDeg(itemMapStart.get(item)!.r, angle) }\n              });\n            }\n          });\n        }\n        break;\n      case \"end\":\n        itemMapStart.clear();\n        break;\n    }\n  }, [resizeStatus.status, resizeStatus.angle, resizeStatus.mx, resizeStatus.my]);\n\n  return { domRef, group };\n\n  function sizeMap(mx: number, my: number, direction: string) {\n    const itemsMap: Map<\n      Item,\n      { x: number; y: number; mx: number; my: number; width: number; height: number }\n    > = new Map();\n    if (itemMapStart.size) {\n      itemMapStart.forEach((state, item) => {\n        const { x, y, width, height } = state;\n        switch (direction) {\n          case \"n\":\n            itemsMap.set(item, { ...state, mx, my, y: y + my, height: height - my });\n            break;\n          case \"s\":\n            itemsMap.set(item, { ...state, mx, my, height: height + my });\n            break;\n          case \"e\":\n            itemsMap.set(item, { ...state, mx, my, width: width + mx });\n            break;\n          case \"w\":\n            itemsMap.set(item, { ...state, mx, my, x: x + mx, width: width - mx });\n            break;\n          case \"ne\":\n            itemsMap.set(item, { ...state, mx, my, y: y + my, height: height - my, width: width + mx });\n            break;\n          case \"nw\":\n            itemsMap.set(item, {\n              ...state,\n              mx,\n              my,\n              y: y + my,\n              x: x + mx,\n              width: width - mx,\n              height: height - my\n            });\n            break;\n          case \"se\":\n            itemsMap.set(item, { ...state, mx, my, width: width + mx, height: height + my });\n            break;\n          case \"sw\":\n            itemsMap.set(item, { ...state, mx, my, x: x + mx, width: width - mx, height: height + my });\n            break;\n        }\n      });\n    }\n    return itemsMap;\n  }\n}\n\nfunction getRotateDeg(original: number, rotated: number) {\n  let mergedRotateDeg = original + Math.round(rotated);\n  mergedRotateDeg = mergedRotateDeg < 0 ? 360 + mergedRotateDeg : mergedRotateDeg;\n  return 357 < mergedRotateDeg || mergedRotateDeg < 3 ? 0 : mergedRotateDeg;\n}\n","import _ from \"lodash\";\nimport React, { MutableRefObject, useEffect, useRef } from \"react\";\nimport { useSelectArea } from \"../Components/SelectArea\";\nimport { useDispatch, useMappedState } from \"../utils\";\n\nexport const SelectAreaView: React.FC<{\n  domRef: MutableRefObject<HTMLDivElement | null>;\n}> = ({ domRef }) => {\n  const { left, width, height, top, status, selectDomRef } = useSelectAreaState(domRef);\n\n  return (\n    <div\n      className=\"select-area\"\n      ref={ref => {\n        if (ref) {\n          selectDomRef.current = ref;\n        }\n      }}\n      style={{\n        display: status === \"moving\" ? \"block\" : \"none\",\n        width: `${width}px`,\n        height: `${height}px`,\n        position: \"absolute\",\n        left: `${left}px`,\n        top: `${top}px`\n      }}\n    />\n  );\n};\n\nfunction useSelectAreaState(domRef: MutableRefObject<HTMLElement | null>) {\n  const selectDomRef = useRef<HTMLElement | undefined>();\n  const dispatch = useDispatch();\n  const { items, selectedItems } = useMappedState(({ editorInstance, selected }) => ({\n    items: editorInstance.items,\n    selectedItems: selected,\n    scale: editorInstance.canvasTransform.s\n  }));\n  const { left, top, width, height, status } = useSelectArea({ domRef });\n\n  useEffect(() => {\n    if (selectDomRef.current) {\n      const selectRect = selectDomRef.current.getBoundingClientRect();\n      items.forEach(item => {\n        if (item.itemView) {\n          const itemRect = item.itemView.getBoundingClientRect();\n          if (isIn(itemRect, selectRect)) {\n            if (!item.groupId) {\n              dispatch({ type: \"SELECT_ITEM\", payload: item });\n            } else {\n              dispatch({ type: \"SELECT_GROUP\", payload: item.groupId });\n            }\n          } else {\n            if (!item.groupId) {\n              dispatch({ type: \"UN_SELECT_ITEM\", payload: item });\n            } else {\n              let flag = false;\n              selectedItems.forEach(selectedItem => {\n                if (selectedItem.groupId === item.groupId && selectedItem.itemView) {\n                  const selectedItemRect = selectedItem.itemView.getBoundingClientRect();\n                  if (isIn(selectedItemRect, selectRect)) {\n                    flag = true;\n                  }\n                }\n              });\n              if (!flag) {\n                selectedItems.forEach(selectedItem => {\n                  if (selectedItem.groupId === item.groupId) {\n                    dispatch({ type: \"UN_SELECT_ITEM\", payload: selectedItem });\n                  }\n                });\n              }\n            }\n          }\n        }\n      });\n    }\n  }, [left, top, width, height]);\n\n  return { left, top, width, height, status, selectDomRef };\n}\n\nfunction isIn(from: ClientRect | DOMRect, to: ClientRect | DOMRect) {\n  return (\n    from.left > to.left &&\n    from.top > to.top &&\n    from.left + from.width < to.left + to.width &&\n    from.top + from.height < to.top + to.height\n  );\n}\n","import React from \"react\";\nimport { useMappedState } from \"../utils\";\n\nexport const ZoomArea: React.FC = ({ children }) => {\n  const {\n    size,\n    transform: { s, x, y }\n  } = useMappedState(({ editorInstance: { canvasSize, canvasTransform } }) => ({\n    size: canvasSize,\n    transform: canvasTransform\n  }));\n\n  return (\n    <div\n      className=\"zoom-area\"\n      style={{\n        position: \"absolute\",\n        width: `${size.width}px`,\n        height: `${size.height}px`,\n        transform: `translate3d(${x}px,${y}px,0) scale(${s})`\n      }}\n    >\n      {children}\n    </div>\n  );\n};\n","import React, { Fragment, useEffect, useRef, useState } from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { useDragState, useZoomState } from \"../Components\";\nimport { Editor } from \"../core\";\nimport { IContextMenuProps } from \"../types/ContextMenu\";\nimport {\n  ContextMenuContext,\n  INITIAL_STATE,\n  makeStore,\n  StoreContext,\n  useDispatch,\n  useMappedState,\n  useStoreDispatch\n} from \"../utils\";\nimport { BorderArea } from \"./BorderArea\";\nimport { Canvas } from \"./Canvas\";\nimport { ContextMenu } from \"./ContextMenu\";\nimport { Grid } from \"./Grid\";\nimport { NoZoomArea } from \"./NoZoomArea\";\nimport { ResizeHandle } from \"./ResizeHandle\";\nimport { SelectAreaView } from \"./SelectArea\";\nimport { ZoomArea } from \"./ZoomArea\";\n\nexport const Content: React.FC = () => {\n  const { editorContainerRef, contextMenuProps, setContextMenuProps, editor } = useEditorState();\n\n  return (\n    <Fragment>\n      <div\n        className=\"editor-container\"\n        ref={ref => {\n          if (ref) {\n            editor.editorView = ref;\n            editorContainerRef.current = ref;\n          }\n        }}\n      >\n        <ContextMenuContext.Provider value={{ setContextMenuProps }}>\n          <NoZoomArea>\n            <Grid />\n          </NoZoomArea>\n          <ZoomArea>\n            <Canvas />\n          </ZoomArea>\n          <NoZoomArea>\n            <BorderArea />\n            <ResizeHandle />\n          </NoZoomArea>\n          <SelectAreaView domRef={editorContainerRef} />\n        </ContextMenuContext.Provider>\n      </div>\n      {contextMenuProps ? <ContextMenu {...contextMenuProps} /> : \"\"}\n    </Fragment>\n  );\n};\n\nlet pointerStart: [number, number] | null = null;\n\nexport function useEditorState() {\n  const editorContainerRef = useRef<HTMLDivElement | null>(null);\n  const storeDispatch = useStoreDispatch();\n  const dispatch = useDispatch();\n  const { transform, editor, size } = useMappedState(state => ({\n    transform: state.editorInstance.canvasTransform,\n    size: state.editorInstance.canvasSize,\n    editor: state.editorInstance\n  }));\n  const [contextMenuProps, setContextMenuProps] = useState<IContextMenuProps>();\n\n  useEffect(() => {\n    let event: Subscription;\n    if (editorContainerRef.current) {\n      event = fromEvent<MouseEvent>(editorContainerRef.current, \"mousedown\").subscribe(() => {\n        dispatch({ type: \"CLEAR_ITEM_SELECT\", payload: undefined });\n        setContextMenuProps(undefined);\n      });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  });\n\n  const zoomTrans = useZoomState({\n    transform,\n    size,\n    intensity: 0.05,\n    domRef: editorContainerRef\n  });\n\n  const [moveStatus] = useDragState({\n    domRef: editorContainerRef,\n    useSpace: true\n  });\n\n  useEffect(() => {\n    if (moveStatus) {\n      switch (moveStatus.status) {\n        case \"drag-start\":\n          pointerStart = [transform.x, transform.y];\n          break;\n        case \"drag-move\":\n          if (pointerStart) {\n            const { mx, my } = moveStatus;\n            dispatch({\n              type: \"SET_CANVAS_TRANSFORM\",\n              payload: { ...transform, x: pointerStart[0] + mx, y: pointerStart[1] + my }\n            });\n          }\n          break;\n        case \"drag-end\":\n          pointerStart = null;\n          break;\n      }\n    }\n  }, [moveStatus]);\n\n  useEffect(() => {\n    let event: Subscription;\n    if (editorContainerRef.current) {\n      event = fromEvent<MouseEvent>(document, \"contextmenu\").subscribe(e => {\n        e.preventDefault();\n        e.stopPropagation();\n      });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [editorContainerRef.current]);\n\n  useEffect(() => {\n    let event: Subscription;\n    if (editor) {\n      event = editor.bus.subscribe(res => {\n        storeDispatch(res);\n      });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [editor]);\n\n  useEffect(() => {\n    const { s, ox, oy } = zoomTrans;\n    const scale = transform.s + s;\n    if (scale >= 0.05 && scale <= 4) {\n      dispatch({\n        type: \"SET_CANVAS_TRANSFORM\",\n        payload: { s: transform.s + s, x: transform.x + ox, y: transform.y + oy }\n      });\n    }\n  }, [zoomTrans]);\n\n  return {\n    editor,\n    editorContainerRef,\n    contextMenuProps,\n    setContextMenuProps\n  };\n}\n\nexport const EditorView = (props: { editor: Editor | null }) => {\n  const [store, setStore] = useState(makeStore(INITIAL_STATE));\n\n  useEffect(() => {\n    if (props.editor) {\n      setStore(\n        makeStore({\n          editorInstance: props.editor,\n          canvasSize: props.editor.canvasSize,\n          canvasTransform: props.editor.canvasTransform\n        })\n      );\n    }\n  }, [props.editor]);\n\n  return (\n    <StoreContext.Provider value={store}>\n      <Content />\n    </StoreContext.Provider>\n  );\n};\n","export * from \"./Canvas\";\nexport * from \"./Editor\";\nexport * from \"./Grid\";\nexport * from \"./NoZoomArea\";\nexport * from \"./SelectArea\";\nexport * from \"./ZoomArea\";\n","import { ISize, ITransform } from \"../types/Editor\";\nimport { EventBus } from \"../utils/event\";\nimport { Item } from \"./item\";\n\nexport class Editor extends EventBus {\n  public id: string;\n  public items: Item[] = [];\n  public canvasTransform: ITransform = { s: 1, x: 0, y: 0 };\n  public canvasSize: ISize = { width: 800, height: 400 };\n  public selected: Set<Item> = new Set();\n  public editorView: HTMLElement | undefined;\n\n  constructor(config?: { size?: ISize; transform?: ITransform; items?: Item[] }) {\n    super(new EventBus());\n    this.id = `${Date.now()}_${Math.round(Math.random() * 10000)}`;\n    if (config) {\n      if (config.size) {\n        this.canvasSize = { ...this.canvasSize, ...config.size };\n      }\n      if (config.transform) {\n        this.canvasTransform = { ...this.canvasTransform, ...config.transform };\n      }\n      if (config.items) {\n        this.items = config.items;\n      }\n    }\n  }\n\n  public addItem(item: Item) {\n    this.emit({ type: \"ADD_ITEM\", payload: item });\n  }\n}\n","export * from \"./editor\";\nexport * from \"./item\";\nexport * from \"./group\";\n","import { MutableRefObject, useEffect, useState } from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { filter } from \"rxjs/operators\";\nimport { ISize, ITransform } from \"../types\";\n\nexport interface IZoomWrapProps {\n  domRef: MutableRefObject<HTMLElement | null>;\n  transform: ITransform;\n  size: ISize;\n  intensity?: number;\n}\n\nexport const useZoomState = (props: IZoomWrapProps) => {\n  const [trans, setTransform] = useState({ s: props.transform.s, ox: 0, oy: 0 });\n\n  useEffect(() => {\n    const refEvent = listenEvent();\n\n    return () => {\n      if (refEvent) {\n        refEvent.unsubscribe();\n      }\n    };\n  }, [props.domRef.current, props.size.width, props.size.height]);\n\n  return trans;\n\n  function wheel(ev: WheelEvent) {\n    const { intensity = 0.01, domRef, size } = props;\n    ev.preventDefault();\n    if (domRef && domRef.current) {\n      const canvasDom: HTMLElement | null = domRef.current.querySelector(\".canvas\") as HTMLElement;\n      if (canvasDom) {\n        const rect = canvasDom.getBoundingClientRect();\n        const wheelDelta = (ev as any).wheelDelta / 120 || -ev.deltaY / 3;\n        const delta = (wheelDelta / Math.abs(wheelDelta)) * intensity;\n        const oxDelta = (delta * size.width) / rect.width;\n        const oyDelta = (delta * size.height) / rect.height;\n        setTransform({\n          s: delta,\n          ox: -(ev.clientX - rect.left) * oxDelta,\n          oy: -(ev.clientY - rect.top) * oyDelta\n        });\n      }\n    }\n  }\n\n  function listenEvent(): Subscription | undefined {\n    if (props.domRef && props.domRef.current) {\n      return fromEvent<WheelEvent>(props.domRef.current, \"wheel\")\n        .pipe(filter(e => e.ctrlKey || e.metaKey))\n        .subscribe(e => wheel(e));\n    }\n  }\n};\n","import { MutableRefObject, useEffect, useState } from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { filter, map, switchMap, takeUntil } from \"rxjs/operators\";\n\ninterface IResizeSelectorStatus {\n  status: \"start\" | \"resizing\" | \"rotating\" | \"end\" | null;\n  direction: string;\n  mx: number;\n  my: number;\n  angle: number;\n}\n\nlet center: [number, number] | null = null;\nlet start: [number, number] | null = null;\nlet oldRotateDeg = 0;\nlet direction: string = \"\";\nconst moveEvent = fromEvent<PointerEvent>(window, \"pointermove\");\nconst upEvent = fromEvent<PointerEvent>(window, \"pointerup\").pipe(filter(e => e.button === 0));\n\nexport function useResizeHandle(props: {\n  domRef: MutableRefObject<HTMLElement | undefined>;\n}): [IResizeSelectorStatus] {\n  const { domRef } = props;\n  const [rotateDeg, setDeg] = useState(0);\n  const [sizeState, setResizeState] = useState({ x: 0, y: 0, direction: \"\" });\n  const [status, setStatus] = useState<IResizeSelectorStatus[\"status\"]>(null);\n\n  useEffect(listenEvent, [props.domRef]);\n\n  return [{ status, mx: sizeState.x, my: sizeState.y, angle: rotateDeg, direction: sizeState.direction }];\n\n  function listenEvent() {\n    let event: Subscription;\n    if (domRef && domRef.current) {\n      event = fromEvent<PointerEvent>(domRef.current, \"pointerdown\")\n        .pipe(\n          filter(e => e.button === 0),\n          map(e => down(e)),\n          switchMap(type => {\n            return moveEvent.pipe(\n              map(e => ({ e, type })),\n              takeUntil(upEvent.pipe(map(ev => up(ev))))\n            );\n          })\n        )\n        .subscribe(({ e, type }) => move(e, type));\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }\n\n  function down(e: PointerEvent) {\n    e.preventDefault();\n    e.stopPropagation();\n    setStatus(\"start\");\n    start = [e.clientX, e.clientY];\n    direction = (e.target as HTMLElement).classList[0];\n    const eleRect = (domRef!.current!.querySelector(\".rect\") as HTMLElement).getBoundingClientRect();\n    center = [eleRect.left + eleRect.width / 2, eleRect.top + eleRect.height / 2];\n    return (e.target as HTMLElement).classList.contains(\"rotate\") ? \"rotate\" : \"resize\";\n  }\n\n  function move(e: PointerEvent, type: \"rotate\" | \"resize\" | undefined) {\n    if (start && center) {\n      const mx = e.clientX - start[0];\n      const my = e.clientY - start[1];\n      switch (type) {\n        case \"resize\":\n          setResizeState({\n            x: mx,\n            y: my,\n            direction\n          });\n          setStatus(\"resizing\");\n          break;\n        case \"rotate\":\n          const r = getRotate([e.clientX, e.clientY]);\n          const d =\n            (start[0] - center[0]) * (e.clientY - center[1]) -\n            (start[1] - center[1]) * (e.clientX - center[0]);\n          if (d > 0) {\n            setDeg(r < oldRotateDeg ? r - 360 : r);\n          } else {\n            setDeg(r < oldRotateDeg ? 360 - r : -r);\n          }\n          oldRotateDeg = r;\n          setStatus(\"rotating\");\n          break;\n      }\n    }\n  }\n\n  function up(e: PointerEvent) {\n    start = null;\n    setStatus(\"end\");\n  }\n}\n\nfunction getRotate(end: [number, number]) {\n  const a2 = Math.pow(end[0] - start![0], 2) + Math.pow(end[1] - start![1], 2);\n  const b2 = Math.pow(end[0] - center![0], 2) + Math.pow(end[1] - center![1], 2);\n  const c2 = Math.pow(start![0] - center![0], 2) + Math.pow(start![1] - center![1], 2);\n  return (Math.acos((b2 + c2 - a2) / (2 * Math.sqrt(b2) * Math.sqrt(c2))) * 180) / Math.PI;\n}\n","import { MutableRefObject, useEffect } from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { switchMap } from \"rxjs/operators\";\nimport { Item } from \"../core\";\nimport { useDispatch, useMappedState } from \"../utils\";\n\nexport function useItemBorderEvent(props: { item: Item; domRef: MutableRefObject<HTMLElement | null> }) {\n  const { domRef, item } = props;\n  const { selectedItems } = useMappedState(({ selected }) => ({\n    selectedItems: selected\n  }));\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    let event: Subscription;\n    if (domRef.current) {\n      event = fromEvent<PointerEvent>(domRef.current, \"pointerover\")\n        .pipe(\n          switchMap(() => {\n            dispatch({ type: \"ADD_ITEM_BORDER\", payload: [item] });\n            return fromEvent<PointerEvent>(domRef.current as HTMLElement, \"pointerout\");\n          })\n        )\n        .subscribe(() => {\n          if (!selectedItems.has(item)) {\n            dispatch({ type: \"REMOVE_ITEM_BORDER\", payload: [item] });\n          }\n        });\n    }\n    return () => {\n      event.unsubscribe();\n    };\n  }, [domRef, selectedItems]);\n}\n","import { useContext, useEffect, useState } from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { filter } from \"rxjs/operators\";\nimport { Item } from \"../core\";\nimport { ContextMenuContext, useDispatch } from \"../utils\";\n\nlet position: [number, number] | null = null;\n\nexport function useItemContextMenuEvent(props: { domRef: HTMLElement | null; item: Item; items: Item[] }) {\n  const { setContextMenuProps } = useContext(ContextMenuContext);\n  const dispatch = useDispatch();\n  const [menuWillShow, setMenuWillShow] = useState<boolean>(false);\n\n  useEffect(() => {\n    let event: Subscription;\n    if (props.domRef && setContextMenuProps) {\n      event = fromEvent<MouseEvent>(props.domRef, \"mousedown\")\n        .pipe(filter(e => e.button === 2))\n        .subscribe(e => {\n          e.preventDefault();\n          e.stopPropagation();\n          position = [e.clientX, e.clientY];\n          setMenuWillShow(true);\n        });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [props.domRef]);\n\n  useEffect(() => {\n    if (menuWillShow) {\n      if (props.items.findIndex(i => i.id === props.item.id) === -1) {\n        dispatch({ type: \"CLEAR_ITEM_SELECT\", payload: undefined });\n        if (props.item.groupId) {\n          dispatch({ type: \"SELECT_GROUP\", payload: props.item.groupId });\n        } else {\n          dispatch({ type: \"SELECT_ITEM\", payload: props.item });\n        }\n      }\n      showContextMenu();\n      setMenuWillShow(false);\n    } else {\n      position = null;\n    }\n  }, [menuWillShow]);\n\n  function showContextMenu() {\n    if (setContextMenuProps && position) {\n      setContextMenuProps({\n        menus: [\n          {\n            key: \"group\",\n            title: \"组合\",\n            hidden: !!props.item.groupId || props.items.length < 2,\n            bottomDivider: true\n          },\n          {\n            key: \"un_group\",\n            title: \"打散\",\n            hidden: !props.item.groupId,\n            bottomDivider: true\n          },\n          { key: \"delete\", title: \"删除\" }\n        ],\n        onClick: menu => itemContextMenuAction(menu.key as any),\n        onClose: () => setContextMenuProps(undefined),\n        visible: true,\n        position: { x: position[0], y: position[1] }\n      });\n    }\n  }\n\n  function itemContextMenuAction(type: \"group\" | \"delete\" | \"un_group\") {\n    switch (type) {\n      case \"delete\":\n        dispatch({ type: \"DELETE_ITEM\", payload: props.items });\n        break;\n      case \"group\":\n        dispatch({ type: \"GROUP_ITEM\", payload: props.items });\n        break;\n      case \"un_group\":\n        dispatch({ type: \"UN_GROUP_ITEM\", payload: props.item.groupId! });\n        break;\n    }\n  }\n}\n","export * from \"./Drag\";\nexport * from \"./SelectArea\";\nexport * from \"./Zoom\";\nexport * from \"./ResizeHandle\";\nexport * from \"./ItemBorder\";\nexport * from \"./ItemContextmenu\";\n","import { Icon } from \"antd\";\n\nexport const IconFont = Icon.createFromIconfontCN({\n  scriptUrl: \"//at.alicdn.com/t/font_1310204_21qcnamjaw6.js\"\n});\n","import React, { FC, Fragment, useEffect, useRef, useState } from \"react\";\nimport { fromEvent, Subscription } from \"rxjs\";\nimport { map, switchMap, takeUntil } from \"rxjs/operators\";\nimport { Editor, Item } from \"../core\";\nimport { ISize } from \"../types\";\nimport { IWidgetTypes, Widgets } from \"../Widgets\";\nimport { IconFont } from \"./components\";\n\nconst moveEvent = fromEvent<PointerEvent>(window, \"pointermove\");\nconst upEvent = fromEvent<PointerEvent>(window, \"pointerup\");\n\nexport const ItemPanel: FC<{ editor: Editor | null }> = ({ editor }) => {\n  return (\n    <div className=\"item-panel\">\n      <ItemIcon editor={editor} type=\"TEXT\" size={{ width: 100, height: 50 }} />\n    </div>\n  );\n};\n\nexport const ItemIcon: FC<{ editor: Editor | null; type: keyof IWidgetTypes; size: ISize }> = ({\n  editor,\n  type,\n  size\n}) => {\n  const { domRef, previewPosition, scale } = useItemIconState(editor, type);\n  const Widget = Widgets[type].Widget;\n  return (\n    <Fragment>\n      <div className=\"item-icon\">\n        <a\n          title=\"文本组件\"\n          ref={ref => {\n            if (ref) {\n              domRef.current = ref;\n            }\n          }}\n        >\n          <IconFont className=\"svg-icon\" type=\"icon-text\" />\n        </a>\n      </div>\n      {previewPosition ? (\n        <div\n          style={{\n            ...size,\n            transformOrigin: \"0 0\",\n            transform: `scale(${scale})`,\n            display: \"block\",\n            position: \"fixed\",\n            zIndex: 99,\n            left: Math.round(previewPosition.x),\n            top: Math.round(previewPosition.y),\n            border: \"1px solid #298df8\",\n            boxSizing: \"border-box\"\n          }}\n        >\n          {<Widget />}\n        </div>\n      ) : (\n        \"\"\n      )}\n    </Fragment>\n  );\n};\n\nexport function useItemIconState(editor: Editor | null, type: keyof IWidgetTypes) {\n  const domRef = useRef<HTMLElement | undefined>();\n  const [previewPosition, setPreview] = useState<{\n    x: number;\n    y: number;\n  } | null>(null);\n\n  useEffect(() => {\n    let event: Subscription;\n    if (domRef.current) {\n      event = fromEvent<PointerEvent>(domRef.current, \"pointerdown\")\n        .pipe(switchMap(() => moveEvent.pipe(takeUntil(upEvent.pipe(map(e => up(e)))))))\n        .subscribe(e => setPreview({ x: e.clientX, y: e.clientY }));\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [domRef, editor]);\n\n  function up(e: PointerEvent) {\n    setPreview(null);\n    const editorDom: HTMLElement | null = document.querySelector(\".editor-content\");\n    if (editorDom && editor) {\n      const { s, x, y } = editor.canvasTransform;\n      const { left, top, width, height } = editorDom.getBoundingClientRect();\n      if (left < e.clientX && top < e.clientY && left + width > e.clientX && top + height > e.clientY) {\n        const item = new Item(type);\n        item.transform.x = (e.clientX - left - x) / s;\n        item.transform.y = (e.clientY - top - y) / s;\n        editor.emit({ type: \"ADD_ITEM\", payload: item });\n      }\n    }\n  }\n\n  return { domRef, previewPosition, scale: editor ? editor.canvasTransform.s : 1 };\n}\n","import { JSONSchema6 } from \"json-schema\";\nimport { UiSchema } from \"react-jsonschema-form\";\nconst schema: JSONSchema6 = {\n  properties: {\n    width: { type: \"number\", title: \"宽\" },\n    height: { type: \"number\", title: \"高\" }\n  }\n};\nconst uiSchema: { [key: string]: UiSchema } & UiSchema = {\n  width: {\n    \"ui:widget\": \"InputNumber\",\n    \"ui:options\": {\n      span: 10,\n      size: \"small\",\n      step: 10,\n      min: 0,\n      labelAlign: \"left\",\n      precision: 0\n    }\n  },\n  height: {\n    \"ui:widget\": \"InputNumber\",\n    \"ui:options\": {\n      span: 10,\n      size: \"small\",\n      step: 10,\n      min: 0,\n      labelAlign: \"left\",\n      precision: 0\n    }\n  }\n};\n\nexport const canvasSchema = { schema, uiSchema };\n","import { JSONSchema6 } from \"json-schema\";\nimport { UiSchema } from \"react-jsonschema-form\";\nconst schema: JSONSchema6 = {\n  properties: {\n    size: {\n      type: \"object\",\n      properties: {\n        width: { type: \"number\", title: \"宽\" },\n        height: { type: \"number\", title: \"高\" }\n      }\n    },\n    transform: {\n      type: \"object\",\n      properties: {\n        // r: { type: \"number\", title: \"旋转\" },\n        x: { type: \"number\", title: \"X\" },\n        y: { type: \"number\", title: \"Y\" }\n      }\n    }\n  }\n};\nconst uiSchema: { [key: string]: UiSchema } & UiSchema = {\n  size: {\n    \"ui:options\": {\n      span: 24,\n      hideLabel: true\n    },\n    \"width\": {\n      \"ui:widget\": \"InputNumber\",\n      \"ui:options\": {\n        precision: 0,\n        span: 10,\n        size: \"small\",\n        step: 1,\n        min: 0,\n        labelFixed: 30,\n        style: { width: \"100%\" }\n      }\n    },\n    \"height\": {\n      \"ui:widget\": \"InputNumber\",\n      \"ui:options\": {\n        precision: 0,\n        span: 10,\n        size: \"small\",\n        step: 1,\n        min: 0,\n        labelFixed: 30,\n        style: { width: \"100%\" }\n      }\n    }\n  },\n  transform: {\n    \"ui:options\": {\n      span: 24,\n      hideLabel: true\n    },\n    \"x\": {\n      \"ui:widget\": \"InputNumber\",\n      \"ui:options\": {\n        precision: 0,\n        span: 10,\n        size: \"small\",\n        step: 1,\n        labelFixed: 30,\n        style: { width: \"100%\" }\n      }\n    },\n    \"y\": {\n      \"ui:widget\": \"InputNumber\",\n      \"ui:options\": {\n        precision: 0,\n        span: 10,\n        size: \"small\",\n        step: 1,\n        labelFixed: 30,\n        style: { width: \"100%\" }\n      }\n    },\n    \"r\": {\n      \"ui:widget\": \"InputNumber\",\n      \"ui:options\": {\n        precision: 0,\n        span: 8,\n        size: \"small\",\n        step: 1,\n        min: 0,\n        max: 360,\n        labelFixed: 30,\n        style: { width: \"100%\" }\n      }\n    }\n  }\n};\n\nexport const itemSchema = { schema, uiSchema };\n","import { Col, Row } from \"antd\";\nimport React from \"react\";\nimport { FieldTemplateProps, ObjectFieldTemplateProps } from \"react-jsonschema-form\";\n\nexport const ObjectFieldTemplate = (props: ObjectFieldTemplateProps) => {\n  const { uiSchema } = props;\n  const { \"ui:options\": options } = uiSchema;\n  const safeOptions = (options || {}) as { [key: string]: any };\n  return (\n    <div className=\"d-flex align-items-center\">\n      {!safeOptions.hideLabel && props.title ? (\n        <span className={`mr-2 ${safeOptions.labelSpan || \"\"}`} style={{ width: safeOptions.labelFixed }}>\n          {props.title}\n        </span>\n      ) : (\n        \"\"\n      )}\n      <div className=\"col pl-1 pr-1\">\n        <Row\n          className=\"mb-2\"\n          gutter={props.uiSchema[\"ui:options\"] ? (props.uiSchema[\"ui:options\"].gutter as number) : undefined}\n        >\n          {props.properties.map(element => element.content)}\n        </Row>\n      </div>\n    </div>\n  );\n};\n\nexport const FieldTemplate = (props: FieldTemplateProps) => {\n  const { classNames, label, help, description, errors, children, uiSchema } = props;\n\n  const { \"ui:options\": options } = uiSchema;\n  const safeOptions = (options || {}) as { [key: string]: any };\n  return (\n    <Col className=\"mb-2\" span={safeOptions.span}>\n      <div className={`d-flex align-items-center ${classNames}`}>\n        {!safeOptions.hideLabel && label ? (\n          <span\n            className={`mr-2 text-${safeOptions.labelAlign || \"right\"}`}\n            style={{ width: safeOptions.labelFixed }}\n          >\n            {label}\n          </span>\n        ) : (\n          \"\"\n        )}\n        <div className=\"col pl-1 pr-1\">\n          {description}\n          {children}\n          {errors}\n          {help}\n        </div>\n      </div>\n    </Col>\n  );\n};\n","import InputNumber from \"./InputNumber\";\nimport Select from \"./Select\";\nimport StringInput from \"./StringInput\";\nexport * from \"./FieldTemplate\";\n\nexport default {\n  StringInput,\n  InputNumber,\n  Select\n};\n","import { Input } from \"antd\";\nimport React from \"react\";\nimport { WidgetProps } from \"react-jsonschema-form\";\n\nexport default (props: WidgetProps) => {\n  const {\n    id,\n    onChange,\n    disabled,\n    options: { type, size, prefix, addonAfter, addonBefore, suffix, allowClear },\n    value,\n    schema: { description }\n  } = props;\n\n  return (\n    <Input\n      {...{\n        onChange: e => onChange(e.target.value),\n        disabled,\n        id,\n        value,\n        placeholder: description\n      }}\n      {...{ type, size, prefix, addonAfter, addonBefore, suffix, allowClear } as any}\n    />\n  );\n};\n","import { InputNumber } from \"antd\";\nimport React from \"react\";\nimport { WidgetProps } from \"react-jsonschema-form\";\n\nexport default (props: WidgetProps) => {\n  const { onChange, value, required, disabled, autofocus, options } = props;\n\n  return (\n    <InputNumber\n      {...{\n        onChange: val => onChange(val),\n        value,\n        required,\n        disabled,\n        autoFocus: autofocus\n      }}\n      {...options as any}\n    />\n  );\n};\n","import { Select } from \"antd\";\nimport React from \"react\";\nimport { WidgetProps } from \"react-jsonschema-form\";\n\nexport default (props: WidgetProps) => {\n  const { onChange, value, disabled, id, options, schema } = props;\n  return (\n    <Select\n      {...{\n        onChange: val => onChange(val),\n        value,\n        disabled,\n        id,\n        placeholder: schema.description\n      }}\n      {...options as any}\n    >\n      {schema.enum\n        ? schema.enum.map((i, index) => {\n            const { label, value: val } = i as { label: string; value: any };\n            return (\n              <Select.Option key={`label_${index}`} title={label} value={val}>\n                {label}\n              </Select.Option>\n            );\n          })\n        : \"\"}\n    </Select>\n  );\n};\n","import { Collapse } from \"antd\";\nimport React, { Dispatch, FC, useEffect, useRef, useState } from \"react\";\nimport Form from \"react-jsonschema-form\";\nimport { Subscription } from \"rxjs\";\nimport { delay } from \"rxjs/operators\";\nimport { Editor, Group, Item } from \"../core\";\nimport { IWidgetProps, WidgetPropsSchemeMap } from \"../Widgets\";\nimport { canvasSchema } from \"./schema/canvas\";\nimport { itemSchema } from \"./schema/item\";\nimport formWidgets, { FieldTemplate, ObjectFieldTemplate } from \"./schema/widgets\";\n\nexport const StylePanel: FC<{ editor: Editor | null }> = ({ editor }) => {\n  const [canvasFormData, updateCanvas] = useCanvasStylePanelState(editor);\n  const [itemBaseStyle, updateItemBaseStyle] = useBaseItemStylePanelState(editor);\n  const [customItemStyle, updateCustomItemStyle, item] = useCustomItemStylePanelState(editor);\n\n  return (\n    <div className=\"style-panel\">\n      <Collapse bordered={false} defaultActiveKey=\"canvas_attr\">\n        <Collapse.Panel key=\"canvas_attr\" header=\"画布属性\">\n          <Form\n            formData={canvasFormData}\n            schema={canvasSchema.schema}\n            uiSchema={canvasSchema.uiSchema}\n            widgets={formWidgets}\n            ObjectFieldTemplate={ObjectFieldTemplate}\n            FieldTemplate={FieldTemplate}\n            onChange={val => {\n              if (val.edit) {\n                updateCanvas(val.formData);\n              }\n            }}\n          >\n            <div />\n          </Form>\n        </Collapse.Panel>\n        <Collapse.Panel key=\"base_item_attr\" header=\"组件基础属性\">\n          <Form\n            formData={itemBaseStyle}\n            schema={itemSchema.schema}\n            uiSchema={itemSchema.uiSchema}\n            widgets={formWidgets}\n            ObjectFieldTemplate={ObjectFieldTemplate}\n            FieldTemplate={FieldTemplate}\n            onChange={val => {\n              if (val.edit) {\n                updateItemBaseStyle(val.formData);\n              }\n            }}\n          >\n            <div />\n          </Form>\n        </Collapse.Panel>\n        {item && item.type !== \"GROUP\" ? (\n          <Collapse.Panel key=\"custom_item_attr\" header=\"组件属性\">\n            <Form\n              formData={customItemStyle}\n              schema={WidgetPropsSchemeMap[item.type].schema}\n              uiSchema={WidgetPropsSchemeMap[item.type].uiSchema}\n              widgets={formWidgets}\n              ObjectFieldTemplate={ObjectFieldTemplate}\n              FieldTemplate={FieldTemplate}\n              onChange={val => {\n                if (val.edit) {\n                  updateCustomItemStyle(val.formData);\n                }\n              }}\n            >\n              <div />\n            </Form>\n          </Collapse.Panel>\n        ) : (\n          \"\"\n        )}\n      </Collapse>\n    </div>\n  );\n};\n\nfunction useCanvasStylePanelState(editor: Editor | null): [any, (data: any) => void] {\n  const [canvasFormData, setCanvasFormData] = useState<any>();\n\n  useEffect(() => {\n    let event: Subscription;\n    if (editor) {\n      const { canvasSize, canvasTransform } = editor;\n      setCanvasFormData({ ...canvasSize, ...canvasTransform });\n      event = editor\n        .on([\"SET_CANVAS_SIZE\"])\n        .pipe(delay(100))\n        .subscribe(() => {\n          setCanvasFormData({ ...editor.canvasSize });\n        });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [editor]);\n\n  const updateCanvas = (data: any) => {\n    if (editor) {\n      editor.emit({ type: \"SET_CANVAS_SIZE\", payload: data });\n    }\n  };\n\n  return [canvasFormData, updateCanvas];\n}\n\nlet groupStart: Group | null = null;\nconst itemMapStart: Map<Item, { r: number; x: number; y: number; width: number; height: number }> = new Map();\nfunction useBaseItemStylePanelState(\n  editor: Editor | null\n): [\n  { transform: Item[\"transform\"]; size: Item[\"size\"] } | undefined,\n  Dispatch<{ transform: Item[\"transform\"]; size: Item[\"size\"] }>\n] {\n  const [itemBaseStyle, setItemBaseStyle] = useState<{ transform: Item[\"transform\"]; size: Item[\"size\"] }>();\n\n  useEffect(() => {\n    let event: Subscription;\n    if (editor) {\n      event = editor\n        .on([\n          \"SELECT_ITEM\",\n          \"SELECT_GROUP\",\n          \"UN_SELECT_ITEM\",\n          \"UN_GROUP_ITEM\",\n          \"MOVE_ITEM\",\n          \"ROTATE_ITEM\",\n          \"RESIZE_ITEM\"\n        ])\n        .pipe(delay(100))\n        .subscribe(() => {\n          const {\n            selected,\n            canvasTransform: { s },\n            canvasSize\n          } = editor;\n          groupStart = new Group(s, [...selected], canvasSize);\n          itemMapStart.clear();\n          if (groupStart.show) {\n            selected.forEach(item => {\n              itemMapStart.set(item, { ...item.transform, ...item.size });\n            });\n            setItemBaseStyle({\n              transform: {\n                r: groupStart.transform.r,\n                x: (groupStart.transform.x * canvasSize.width) / 100,\n                y: (groupStart.transform.y * canvasSize.height) / 100\n              },\n              size: {\n                width: (groupStart.size.width * canvasSize.width) / 100,\n                height: (groupStart.size.height * canvasSize.height) / 100\n              }\n            });\n          } else {\n            groupStart = null;\n            setItemBaseStyle(undefined);\n          }\n        });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [editor]);\n\n  const updateItemBaseStyle = (data: { transform: Item[\"transform\"]; size: Item[\"size\"] }) => {\n    if (editor && groupStart) {\n      const { transform, size } = data;\n      const { canvasSize } = editor;\n      const increaseX = transform.x - (groupStart.transform.x * canvasSize.width) / 100;\n      const increaseY = transform.y - (groupStart.transform.y * canvasSize.height) / 100;\n      const increaseW = size.width - (groupStart.size.width * canvasSize.width) / 100;\n      const increaseH = size.height - (groupStart.size.height * canvasSize.height) / 100;\n\n      const itemMap = new Map<\n        Item,\n        { x: number; y: number; mx: number; my: number; width: number; height: number }\n      >();\n      itemMapStart.forEach(({ x, y, width, height }, item) => {\n        itemMap.set(item, {\n          x: x + increaseX,\n          y: y + increaseY,\n          mx: increaseX,\n          my: increaseY,\n          width: width + increaseW,\n          height: height + increaseH\n        });\n      });\n\n      editor.emit({ type: \"MOVE_ITEM\", payload: itemMap });\n      editor.emit({ type: \"RESIZE_ITEM\", payload: itemMap });\n      if (itemMap.size === 1) {\n        editor.emit({ type: \"ROTATE_ITEM\", payload: { item: itemMap.keys().next().value, r: transform.r } });\n      }\n    }\n  };\n\n  return [itemBaseStyle, updateItemBaseStyle];\n}\n\nlet itemSet: Set<Item> | null = null;\nfunction useCustomItemStylePanelState<K extends keyof IWidgetProps>(\n  editor: Editor | null\n): [IWidgetProps[K] | undefined, (data: IWidgetProps[K]) => void, Item | null] {\n  const [itemProps, setItemProps] = useState<IWidgetProps[K]>();\n  const [item, setItem] = useState<Item | null>(null);\n\n  useEffect(() => {\n    let event: Subscription;\n    if (editor) {\n      event = editor.bus.pipe(delay(100)).subscribe(() => {\n        itemSet = editor.selected;\n        if (itemSet.size === 1) {\n          setItem(itemSet.values().next().value);\n          setItemProps(itemSet.values().next().value.props);\n        } else {\n          setItem(null);\n        }\n      });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [editor]);\n\n  const updateItemProps = (data: IWidgetProps[K]) => {\n    if (editor && itemSet && itemSet.size === 1) {\n      editor.emit({ type: \"SET_ITEM_DATA\", payload: { id: itemSet.values().next().value.id, data } });\n    }\n  };\n\n  return [itemProps, updateItemProps, item];\n}\n","import React, { FC, useEffect, useRef, useState } from \"react\";\nimport { Subscription } from \"rxjs\";\nimport { delay } from \"rxjs/operators\";\nimport { Group } from \"../core/group\";\nimport { Editor, Item } from \"../editor\";\nimport { IconFont } from \"./components\";\n\nexport type IAlignDirection =\n  | \"left\"\n  | \"right\"\n  | \"top\"\n  | \"bottom\"\n  | \"vertical\"\n  | \"horizontal\"\n  | \"vertical-between\"\n  | \"horizontal-between\";\n\nexport const Toolbar: FC<{ editor: Editor | null }> = ({ editor }) => {\n  const {\n    scale,\n    setScale,\n    setAlign,\n    items,\n    groupId,\n    toolbarStatus: { hasSelected, isGroup, canGroup }\n  } = useToolbarState(editor);\n  const className = `toolbar-item ${hasSelected ? \"\" : \"disabled\"}`;\n\n  return (\n    <div className=\"toolbar\">\n      <div className=\"title\">\n        <div className=\"action\">\n          <IconFont className=\"svg-icon\" type=\"icon-left-arrow\" />\n        </div>\n        <div className=\"title-content\">测试画面</div>\n      </div>\n      <div className=\"toolbar-center\">\n        <div>\n          <a\n            className={className}\n            title=\"左对齐\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"left\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-left-align\" />\n            </div>\n          </a>\n          <a\n            className={className}\n            title=\"右对齐\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"right\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-right-align\" />\n            </div>\n          </a>\n          <a\n            className={className}\n            title=\"上对齐\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"top\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-top-align\" />\n            </div>\n          </a>\n          <a\n            className={className}\n            title=\"下对齐\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"bottom\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-bottom-align\" />\n            </div>\n          </a>\n          <a\n            className={className}\n            title=\"垂直对齐\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"vertical\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-vertical-align\" />\n            </div>\n          </a>\n          <a\n            className={className}\n            title=\"水平对齐\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"horizontal\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-horizontal-align\" />\n            </div>\n          </a>\n          <a\n            className={`toolbar-item ${canGroup ? \"\" : \"disabled\"}`}\n            title=\"水平分布\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"horizontal-between\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-horizontal-between\" />\n            </div>\n          </a>\n          <a\n            className={`toolbar-item ${canGroup ? \"\" : \"disabled\"}`}\n            title=\"垂直分布\"\n            onClick={() => {\n              if (canGroup) {\n                setAlign(\"vertical-between\");\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-vertical-between\" />\n            </div>\n          </a>\n        </div>\n        <div>\n          <a className={`toolbar-item`} title=\"撤销\">\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-Undo\" />\n            </div>\n          </a>\n          <a className={`toolbar-item`} title=\"重做\">\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-Redo\" />\n            </div>\n          </a>\n        </div>\n        <div>\n          <a\n            className={`toolbar-item ${canGroup ? \"\" : \"disabled\"}`}\n            title=\"组合\"\n            onClick={() => {\n              if (canGroup && editor) {\n                editor.emit({ type: \"GROUP_ITEM\", payload: items });\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-group\" />\n            </div>\n          </a>\n          <a\n            className={`toolbar-item ${isGroup ? \"\" : \"disabled\"}`}\n            title=\"打散\"\n            onClick={() => {\n              if (isGroup && editor) {\n                editor.emit({ type: \"UN_GROUP_ITEM\", payload: groupId! });\n              }\n            }}\n          >\n            <div className=\"icon\">\n              <IconFont className=\"svg-icon\" type=\"icon-break\" />\n            </div>\n          </a>\n        </div>\n        <div>\n          <div className=\"zoom-button-group\">\n            <a\n              onClick={() => {\n                setScale(scale.current - 5);\n              }}\n            >\n              <IconFont className=\"svg-icon\" type=\"icon-subtract\" />\n            </a>\n            <a onDoubleClick={() => setScale(100)}>{Math.round(scale.current)}%</a>\n            <a\n              onClick={() => {\n                setScale(scale.current + 5);\n              }}\n            >\n              <IconFont className=\"svg-icon\" type=\"icon-plus\" />\n            </a>\n          </div>\n        </div>\n      </div>\n      <div className=\"toolbar-right\" />\n    </div>\n  );\n};\n\nexport function useToolbarState(editor: Editor | null) {\n  const scale = useRef<number>(100);\n  const [items, setItems] = useState<Item[]>([]);\n  const [groupId, setGroupId] = useState<string | null>(null);\n  const [toolbarStatus, setStatus] = useState({\n    isGroup: false,\n    hasSelected: false,\n    canGroup: false\n  });\n\n  useEffect(() => {\n    let event: Subscription;\n    if (editor) {\n      event = editor.bus.pipe(delay(100)).subscribe(() => {\n        setItems([...editor.selected]);\n        scale.current = editor.canvasTransform.s * 100;\n      });\n    }\n    return () => {\n      if (event) {\n        event.unsubscribe();\n      }\n    };\n  }, [editor]);\n\n  useEffect(() => {\n    if (items.length) {\n      if (items.length > 1) {\n        if (items[0].groupId) {\n          setGroupId(items[0].groupId);\n          setStatus({ canGroup: false, isGroup: true, hasSelected: true });\n        } else {\n          setStatus({ canGroup: true, isGroup: false, hasSelected: true });\n        }\n      } else {\n        setStatus({ canGroup: false, isGroup: false, hasSelected: true });\n      }\n    } else {\n      setStatus({ canGroup: false, isGroup: false, hasSelected: false });\n    }\n  }, [items]);\n\n  const setScale = (s: number) => {\n    if (editor && editor.editorView) {\n      const { x, y } = editor.canvasTransform;\n      editor.emit({\n        type: \"SET_CANVAS_TRANSFORM\",\n        payload: { s: s / 100, x, y }\n      });\n    }\n  };\n\n  const setAlign = (direction: IAlignDirection) => {\n    if (editor) {\n      const { canvasTransform, canvasSize } = editor;\n      if (toolbarStatus.canGroup && items.length > 1) {\n        const group = new Group(canvasTransform.s, items, canvasSize);\n        switch (direction) {\n          case \"left\":\n            break;\n          case \"right\":\n            break;\n          case \"top\":\n            break;\n          case \"bottom\":\n            break;\n          case \"vertical\":\n            break;\n          case \"horizontal\":\n            break;\n          case \"vertical-between\":\n            break;\n          case \"horizontal-between\":\n            break;\n        }\n      }\n    }\n  };\n\n  return { toolbarStatus, groupId, items, scale, setScale, setAlign, editor };\n}\n","import React, { createContext, useEffect, useState } from \"react\";\nimport { Editor, EditorView } from \"./editor\";\nimport { ItemPanel } from \"./layout/ItemPanel\";\nimport { StylePanel } from \"./layout/StylePanel\";\nimport { Toolbar } from \"./layout/Toolbar\";\n\nexport const EditorContext = createContext<Editor | null>(null);\n\nexport const App: React.FC = () => {\n  const [editor, setEditor] = useState<Editor | null>(null);\n\n  useEffect(() => {\n    const editorInstance = new Editor({\n      size: { width: 500, height: 250 },\n      transform: { s: 1, x: 200, y: 200 }\n    });\n    setEditor(editorInstance);\n  }, []);\n\n  return (\n    <div className=\"main\">\n      <Toolbar editor={editor} />\n      <div className=\"main-content\">\n        <ItemPanel editor={editor} />\n        <div className=\"editor-content\">\n          <EditorView editor={editor} />\n        </div>\n        <StylePanel editor={editor} />\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n/*eslint-disable*/\n/* tslint:disable */\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\ninterface Config {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { App } from \"./App\";\nimport \"./index.scss\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root-block\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import { JSONSchema6 } from \"json-schema\";\nimport React from \"react\";\nimport { UiSchema } from \"react-jsonschema-form\";\nimport { ITextProps } from \"../types\";\n\nconst defaultProps: ITextProps = {\n  text: \"文本组件\",\n  textAlign: \"center\",\n  verticalAlign: \"center\"\n};\n\nexport default defaultProps;\n\nexport const Text: React.FC<ITextProps> = options => {\n  const props = { ...defaultProps, ...options };\n  return (\n    <div\n      style={{\n        width: \"100%\",\n        height: \"100%\",\n        display: \"flex\",\n        justifyContent: props.textAlign,\n        alignItems: props.verticalAlign\n      }}\n    >\n      <span>{props.text}</span>\n    </div>\n  );\n};\n\nexport const TextPropsSchema: JSONSchema6 = {\n  properties: {\n    text: { type: \"string\", title: \"文本内容\" },\n    textAlign: {\n      type: \"string\",\n      title: \"水平对齐\",\n      enum: [\n        { label: \"左对齐\", value: \"flex-start\" },\n        { label: \"居中对齐\", value: \"center\" },\n        { label: \"右对齐\", value: \"flex-end\" }\n      ]\n    },\n    verticalAlign: {\n      type: \"string\",\n      title: \"垂直对齐\",\n      enum: [\n        { label: \"上对齐\", value: \"flex-start\" },\n        { label: \"居中对齐\", value: \"center\" },\n        { label: \"下对齐\", value: \"flex-end\" }\n      ]\n    }\n  }\n};\n\nexport const TextPropsUiSchema: { [k in keyof ITextProps]: UiSchema } = {\n  text: {\n    \"ui:widget\": \"StringInput\",\n    \"ui:options\": { span: 24, labelFixed: 100, size: \"small\" }\n  },\n  textAlign: {\n    \"ui:widget\": \"Select\",\n    \"ui:options\": { span: 24, labelFixed: 100, size: \"small\" }\n  },\n  verticalAlign: {\n    \"ui:widget\": \"Select\",\n    \"ui:options\": { span: 24, labelFixed: 100, size: \"small\" }\n  }\n};\n","import { Text, TextPropsSchema } from \"./Text\";\nimport TextProps, { TextPropsUiSchema } from \"./Text/index\";\nimport { ITextProps } from \"./types\";\n\nexport * from \"./Text\";\nexport * from \"./types\";\n\nexport interface IWidgetTypes {\n  TEXT: ITextProps;\n}\n\nexport const Widgets = {\n  TEXT: {\n    Widget: Text,\n    props: TextProps\n  }\n};\n\nexport const WidgetPropsSchemeMap = {\n  TEXT: { schema: TextPropsSchema, uiSchema: TextPropsUiSchema }\n};\n"],"sourceRoot":""}